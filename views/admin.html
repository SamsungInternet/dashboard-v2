<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="#222222">
    <title>Dashboard Admin</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/favicon.png" type="image/png">
    <script defer src="lib/moment.js"></script>
    <script defer src="client-util.js"></script>
    <script defer src="client-admin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
  </head>
  <body>
    <header>
      <a class="logout" href="/logout">Logout</a>
      <div class="logo">
        <img height="70px" src="https://cdn.glitch.com/c8d6680f-b489-4c42-9449-52c9416ae9fa%2Fsamsung-internet-logo-text.svg?1534247440236" alt="Samsung Internet logo"/>
      </div>
      <div class="title-and-last-updated">
        <h1>Developer Advocacy Dashboard Admin</h1>
      </div>
    </header>
    <main class="admin">
      <h2>Automatic Scraping</h2>
      <p>
        Hit this button to go and scrape the web for all the data that is publicly available.
      </p>
      <div v-cloak id="automatic-stats">
        <p>
          <button v-if="updating" class="auto-update" disabled="true">Updating</button>
          <button v-else class="auto-update" v-on:click.prevent="onClickUpdate">Update</button>
        </p>
        <p v-if="updates.length">Updated, saving new values:</p>
        <ul>
          <li v-for="update in updates">
            <strong>{{ update.key }}:</strong> {{update.value}}
          </li>
        </ul>
      </div>
      <h2>Manual Entry</h2>
      <p>
        These stats are behind logins - some with 2FA switched on, which makes it extra hard to scrape automatically.
        Please update the numbers here inline and they will update on the dashboard.
      </p>
      <div v-cloak id="manual-stats">
        <p><em>Last updated: <span id="lastUpdated">{{lastUpdatedTime}}</span></em></p>
        <div class="numbers">
          <div>
            <input type="number" v-on:keyup="onKeyUp" v-model.number="stats.mediumViews.mostRecent.value" id="mediumViews">
            <p>Medium views (30 days) (<a href="https://medium.com/samsung-internet-dev/stats/overview">find here</a>)</p>
          </div>
          <div>
            <input type="number" v-on:keyup="onKeyUp" v-model.number="stats.twitterImpressions.mostRecent.value" id="twitterImpressions">
            <p>Tweet impressions (28 days) (<a href="https://analytics.twitter.com">find here</a>)</p>
          </div>
          <div>
            <input type="number" v-on:keyup="onKeyUp" v-model.number="stats.twitterMentions.mostRecent.value" id="twitterMentions">
            <p>Twitter mentions (28 days) (<a href="https://analytics.twitter.com">find here</a>)</p>
          </div>
          <div>
            <input type="number" v-on:keyup="onKeyUp" v-model.number="stats.devHubUniqueVisitors.mostRecent.value" id="devHubUniqueVisitors">
            <p>Dev Hub unique visitors (Last month - <strong>Temporary!</strong> We can automate when new Dev Hub analytics is live) (<a href="https://dash.cloudflare.com/07f6031276cb9cbf9dca84a1727cabbc/samsunginter.net/analytics">find here</a>)</p>
          </div>
          <div>
            <input type="number" v-on:keyup="onKeyUp" v-model.number="stats.facebookFollowers.mostRecent.value" id="facebookFollowers">
            <p>Facebook followers (<strong>Annoying!</strong> If someone wants to use their Facebook account it should be possible to get this from the API. I tried scraping but it doesn't seem possible - their HTML is obfuscated, AJAX-y junk) (<a href="https://facebook.com/samsunginternet">find here</a>)</p>
          </div>
        </div>
      </div>
    </main>
    <footer>
      <p>&copy; 2018 Samsung Internet &middot; <a href="https://glitch.com/edit/#!/samsung-internet-dashboard">Source on Glitch</a></p>
    </footer>
  </body>
</html>
